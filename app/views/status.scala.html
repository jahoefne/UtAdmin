@(loggedInUser: UtAdminUser)(implicit lang: play.api.i18n.Lang)

<script src="@routes.Assets.at("javascripts/status.js")"></script>

<div class="container module" id="status-module"
ng-controller="OnlinePlayerCtrl"
ng-init="init()"
ng-cloak
>

    <link href="@routes.Assets.at("javascripts/deps/flag-icon-css/css/flag-icon.min.css")" rel="stylesheet">

    <div class="row">
        <div class="col s6 push-s3">
            <div class="card horizontal">
                <div class="card-image">
                    <img src=http://cache.www.gametracker.com/images/graphs/server_players.php?GSID=5036943&start=-1d">
                </div>
                <div class="card-stacked">
                    <div class="card-content">
                        <h6>@UtServer.name</h6>

                        <span>
                            Right now there<ng-pluralize count="players.length" when="{'0': '\'s nobody online.', 'one': '\'s 1 player online.', 'other': '\'re {} players online.'}"></ng-pluralize>
                        </span>
                    </div>
                    <div class="card-action">
                        <a id="restartServerButton" class="btn btn-flat waves-effect" ng-click="restartServer()">Restart Server</a>
                        <a id="restartB3Button" class="btn btn-flat waves-effect" ng-click="restartB3()">Restart B3</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="statusPanel">
        <div class="card-panel center">
            <table class="bordered highlight status-table">
                <thead>
                    <tr>
                        <th><mac-spinner ng-show="updating" mac-spinner-color="white"/></th>
                        <th>Name</th>
                        <th>Rank</th>
                        <th>Score</th>
                        <th>Ip</th>
                        <th>Online</th>
                        <th>PM</th>
                        <th>Chatlog</th>
                        <th>Punish</th>
                        <th>Penalties</th>
                    </tr>
                </thead>

                <tbody ng:repeat="player in players" >
                    <tr>
                        <td>
                            <i class="material-icons {{player.team}}-text">label</i>
                            <span class="flag-icon flag-icon-{{player.countryCode | lowercase}} status-flag" mac-tooltip="{{player.country}}" mac-tooltip-direction="top"></span>
                        </td>
                        <td><a href="/user?id={{player.id}}" target="_blank">{{player.name | urtstring}}</a></td>
                        <td mac-tooltip="{{player.group.name}}" mac-tooltip-direction="left">
                            <i class="material-icons grey-text" ng-show="{{player.group.level}}==0">face</i>
                            <i class="material-icons grey-text text-lighten-2" ng-show="{{player.group.level}}==1">face</i>
                            <i class="material-icons grey-text text-lighten-3" ng-show="{{player.group.level}}==20">face</i>
                            <i class="material-icons grey-text" ng-show="{{player.group.level}}==30">face</i>
                            <i class="material-icons green-text" ng-show="{{player.group.level}}==40">face</i>
                            <i class="material-icons green-text" ng-show="{{player.group.level}}==50">star</i>
                            <i class="material-icons amber-text" ng-show="{{player.group.level}}==55">star</i>
                            <i class="material-icons amber-text text-lighten-4" ng-show="{{player.group.level}}==60">star</i>
                            <i class="material-icons god-icon" ng-show="{{player.group.level}}>=80">stars</i>
                        </td>
                        <td>{{player.score}}</td>
                        <td><a href="https://www.whoismyisp.org/ip/{{player.ip}}" target="_blank">{{player.ip}}</a></td>
                        <td>
                            <span class="time-stamp" mac-tooltip="{{player.joined | date:'medium'}}" mac-tooltip-direction="top">{{player.joined/1000 | timestamp}}</span>
                        </td>
                        <td>
                            <span class="waves-effect btn-flat white-text" ng-click="pm(player.serverId,player.name,player.id)">
                                <i class="material-icons">message</i>
                            </span>
                        </td>
                        <td mac-tooltip="Show chatlog of {{player.name}}" mac-tooltip-direction="top">
                            <a class="waves-effect btn-flat" ng-click="showChatForUser(player.id)">
                                <i class="material-icons">redo</i>
                            </a>
                        </td>
                        <td>
                            <a class="waves-effect btn-flat" ng-click="punishModal(player.serverId,player.name)">
                                <i class="material-icons">pan_tool</i>
                            </a>
                        </td>
                        <td mac-tooltip="Show penalties of {{player.name}}" mac-tooltip-direction="top">
                            <a class="waves-effect btn-flat" ng-click="showPenaltiesForUser(player.id)">
                                <i class="material-icons">redo</i>
                            </a>
                        </td>
                    </tr>

                </tbody>
            </table>
        </div>
    </div>
</div>

